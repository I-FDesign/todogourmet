<div class="login-content">
    <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <!-- <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Iniciar Sesion</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> -->
                <div class="modal-body">
                    <div class="login text-center animated fadeIn faster">
                        <div class="login-container">
                            <div class="login-form">
                                <div class="explanation">
                                    <p>Ingresa tu numero, completa el CAPTCHA y te enviaremos un codigo para verificar tu identidad!</p>
                                </div>
                                <div class='form-content'>
                                    <form class='sign-in-form'>
                                        <div class="phone-number">
                                            <div class="number-item little">
                                                <label for="pais">País</label>
                                                <div class="country">
                                                    <span>+</span>
                                                    <input id="pais" [(ngModel)]="phone.country" name='country' maxlength="2" class='form-control mb-3' type="text" placeholder="54" disabled>
                                                </div>
                                            </div>
                                            <div class="number-item little">
                                                <label for="area">Area</label>
                                                <input id="area" [(ngModel)]="phone.area" name='area' maxlength="3" class='form-control mb-3' type="text" disabled>
                                            </div>
                                            <div class="number-item little">
                                                <label for="prefijo">Prefijo</label>
                                                <input id="prefijo" [(ngModel)]="phone.prefix" name='prefix' maxlength="3" class='form-control mb-3' type="text" placeholder="11">
                                            </div>
                                            <div class="number-item">
                                                <label for="numero">Número</label>
                                                <input id="numero" [(ngModel)]="phone.line" name='line' maxlength="8" class='form-control mb-3' type="text" placeholder="12345678">
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="recaptcha-container" id='recaptcha-container'></div>
                                        <div class="error text-danger" *ngIf='numberError'>
                                            <p>Ha ocurrido un error al enviar el mensaje, probablemente has realizado demasiados intentos. Prueba mas tarde!</p>
                                        </div>
                                    </form>
                                </div>
                            </div>

                            <div class='animated fadeIn faster verification-code' *ngIf="windowRef.confirmationResult">
                                <hr>
                                <h4>Ingresa tu codigo de verificación</h4>
                                <div class="col-sm-6 code-input">
                                    <input name="code" [(ngModel)]="verificationCode" class='form-control' type="text" placeholder="Ingresa el código">
                                    <button class='mt-2 btn btn-success' (click)="verifyLoginCode()">Verificar</button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-danger" data-dismiss="modal">
                Cerrar
            </button>
                    <button (click)="sendLoginCode()" [disabled]="!phone.isValid()" type='submit' class="btn-outline-success btn">Enviar codigo</button>
                </div>
            </div>
        </div>
    </div>

    <button *ngIf='!loginService.user._id' type="button" class="login-button" data-toggle="modal" data-target="#loginModal">
        <i class="fa fa-sign-in" aria-hidden="true"></i>
        Iniciar sesión
    </button>
    <button *ngIf='loginService.user._id && cartService.cartProductsLength > 0' 
        type="button" class="cart-button" routerLink='/carrito'>
        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
        <span>{{ cartService.cartProductsLength }}</span>
    </button>
</div>

<div class="modal fade" id="additionalInfoModal" tabindex="-1" role="dialog" aria-labelledby="additionalInfoModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="additionalInfoModalLabel">Datos adicionales</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #f='ngForm'>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Nombre y apellido:</label>
            <input type="text" [(ngModel)]="loginService.user.name" name='name'
                class="form-control" id="recipient-name" placeholder="Nombre y apellido">
          </div>
          <div class="form-group">
            <label for="recipient-address" class="col-form-label">Dirección de entrega:</label>
            <input type="text" [(ngModel)]="loginService.user.shippingAddress" name='shippingAddress'
                class="form-control" id="recipient-address" placeholder="Dirección ejemplo 234">
          </div>
          <div class="form-group">
                <label for="recipient-email" class="col-form-label">Correo electronico:</label>
                <input type="text" [(ngModel)]="loginService.user.userEmail" name='userEmail'
                    class="form-control" id="recipient-email" placeholder="tucorreo@correo.com">
          </div>
          <div class="commerce-options" *ngIf='loginService.isCommerce'>
            <div class="form-group">
                <label for="commerce_name" class="col-form-label">Nombre comercio:</label>
                <input type="text" [(ngModel)]="loginService.user.commerceName" name='commerceName'
                    class="form-control" id="commerce_name" placeholder="tucorreo@correo.com">
            </div>
            <div class="form-group hours" >
                <label for="recipient-name" class="col-form-label">Horarios de atención:</label>
                <div class="horarios text-center">
                    <div class="others d-flex justify-content-between mb-2">
                        <div class="btn-group mr-2 " role="group" aria-label="First group">
                            <button (click)="changeHour('global', 'Lunes a Viernes')"
                                type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.hours !== 'Lunes a Viernes', 'btn-danger': loginService.user.hours === 'Lunes a Viernes'}">
                                LU a VI</button>
                            <button (click)="changeHour('global', 'Lunes a Sabados')"
                                type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.hours !== 'Lunes a Sabados', 'btn-danger': loginService.user.hours === 'Lunes a Sabados'}">
                                LU a SAB</button>
                        </div>
                        <div class="more">
                            <button (click)='moreHours = !moreHours'
                                type="button" class="btn btn-outline-danger" >
                                Añadir horario
                            </button>
                        </div>
                    </div>
                    <div class="mas-horarios" *ngIf='moreHours'>
                        <div class="input-group mt-1 mb-3">
                            <input [(ngModel)]="loginService.user.additionalHours" name='additionalHours'
                                type="text" class="form-control" placeholder="Especifica un horario">
                        </div>
                    </div>  
                    <div class="btn-group mr-2" role="group" aria-label="First group">
                        <button (click)="changeHour('specific', 'Lunes')"
                            type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Lunes') === - 1, 'btn-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Lunes') > - 1}">
                            LU
                        </button>
                        <button (click)="changeHour('specific', 'Martes')"
                            type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Martes') === - 1, 'btn-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Martes') > - 1}">
                            MA
                        </button>
                        <button (click)="changeHour('specific', 'Miercoles')"
                            type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Miercoles') === - 1, 'btn-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Miercoles') > - 1}">
                            MIE
                        </button>
                        <button (click)="changeHour('specific', 'Jueves')"
                            type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Jueves') === - 1, 'btn-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Jueves') > - 1}">
                            JUE
                        </button>
                        <button (click)="changeHour('specific', 'Viernes')"
                            type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Viernes') === - 1, 'btn-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Viernes') > - 1}">
                            VIE
                        </button>
                        <button (click)="changeHour('specific', 'Sabado')"
                            type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Sabado') === - 1, 'btn-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Sabado') > - 1}">
                            SAB
                        </button>
                        <button (click)="changeHour('specific', 'Domingo')"
                            type="button" class="btn" [ngClass]="{'btn-outline-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Domingo') === - 1, 'btn-danger': loginService.user.specificHours && loginService.user.specificHours.indexOf('Domingo') > - 1}">
                            DOM
                        </button>
                    </div>                      
                </div>
            </div>
           </div>
            <div class="ml-1 location">
                <div class="form-group w-100 mb-2" *ngIf='provincias.length > 0'>
                    <label for="provinciaId">Provincia</label>
                    <select [(ngModel)]="loginService.user.provincia.id"
                        (change)='gobAPIService.provinceChanged()'
                        name="provinciaId" id="provinciaId" class="form-control">
                        <option value="">Selecciona una provincia</option>
                        <option *ngFor='let provincia of provincias' value="{{ provincia.id }}">
                            {{ provincia.nombre }}
                        </option>
                    </select>
                </div>
                        
                <div class="form-group w-100" *ngIf='gobAPIService.localidades'>
                    <label for="localidadId">Localidad</label>
                    <select [(ngModel)]="loginService.user.localidad.id"
                        (change)='gobAPIService.localidadChanged()'
                        name="localidadId" id="localidadId" class="form-control">
                        <option value="">Selecciona una localidad</option>
                        <option *ngFor='let localidad of gobAPIService.localidades' value="{{ localidad.id }}">
                            {{ localidad.nombre }}
                        </option>
                    </select>
                </div>
            </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" (click)='additionalInfo(f.value)'
            class="btn btn-danger">
            Guardar datos
        </button>
      </div>
    </div>
  </div>
</div>

<!-- <button data-toggle="modal" data-target="#additionalInfoModal">Abirr</button> -->